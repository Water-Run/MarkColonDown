# 基本概念  

`Mark:down`是一个强大的`Markdown`预处理器. 作为`Markdown`的严格超集, 由`.md`编译为`.md`, 大幅扩展了`Markdown`的能力.  
`Mark:down`开源于[GitHub](https://github.com/Water-Run/MarkColonDown).

## 能力概览  

`Mark:down`以`#:`("行指令", 也是项目名称的来源), 结合`{{}}`(代码内嵌)等语法, 为`Markdown`的编写实现了:  

1. **语法糖**. 将常用的 Markdown 结构压缩为简洁指令. `#:1` 到 `#:6` 对应各级标题, `#:!` 快速插入图片, `#:-` 和 `#:|` 以逗号分隔的方式构建表格, 等等. 每个指令都提供简化形式, 如 `#:image` 可写为 `#:!`, 在保持可读性的同时提升编写效率.

2. **预处理能力**. 通过 `#:include` 实现文件级别的模块化组织, 常将全局变量集中在 `Global.md` 中统一管理, 或将公共模板抽离为独立文件按需导入. `#:define` 提供编译期的查找替换, 配合 `Include_Base` 等编译指令设定的基路径, 构建起类似 C 语言头文件的依赖管理机制.

3. **控制流**. 使用 `#:if`/`#:elif`/`#:else` 根据表达式结果选择性输出内容, `#:for` 遍历数据结构批量生成段落, `#:while` 处理需要循环的场景. 结合 `#:<flag>` 语法可以根据编译时传入的标记(通过 `--flag` 参数)动态启用或禁用特定指令, 实现同一源码编译出不同版本文档的能力.

4. **内嵌代码**. 在 `#:code` 块中执行 `MiniScript` 脚本进行逻辑计算或调用外部 `lua` 模块, 并通过 `{{ }}` 将表达式结果嵌入正文. 灵活强大带来了极大的可能性.

5. **模板系统**. 用 `#:template` 声明带参数的可复用结构, 通过 `#:use` 传入实参展开生成. 适合将重复的格式(如 API 文档条目, 变更日志项)抽象为模板, 维护时只需修改一处定义.

## 安装  

从[Release](https://github.com/Water-Run/MarkColonDown/releases)下载(对应系统版本);  
运行`install.bat`(Windows)/`install.sh`(Linux), 依照指引进行.  

> 同样的, 卸载可以使用`uninstall.bat`/`uninstall.sh`进行  

安装完成后, 执行`mcd`指令(即`MarkColonDownCompiler`, `Mark:down`编译器), 验证安装:  

```cmd
Mark:down

v0.1.0, by WaterRun.

A powerful Markdown template engine, implemented as a strict superset of Markdown,
with "#:" line directives as the distinctive syntax, and embedded neolua.

Usage:
  mcd <command> [options]

Commands:
  init       Initialize a Mark:down project
             Generates Compile.md entry file and corresponding Log.md
             
  compile    Execute compilation
             Compiles Mark:down source files to Markdown output

Examples:
  mcd init                    # Initialize project in current directory
  mcd compile                 # Compile the project
  mcd init --entry ./docs     # Initialize in specified directory
  mcd compile --use Config.md # Compile with custom configuration file

GitHub: https://github.com/Water-Run/MarkColonDown

(On Linux, use 'man mcd' for detailed help)
```

> 在Linux上, 另可使用`man`指令获取帮助  

## `Mark:down`的工作流简述  

## 行指令速览表  

你可以阅读此表快速的过一遍`Mark:down`提供的行指令:  

## 关于代码内嵌  

`MiniScript`代码的内嵌可能是`Mark:down`最强大的功能, 条件判断也依赖于它. 同时, 它也很危险--`Mark:down`并不会判断你的执行的代码的安全性, 你需要自己负责.  
在之前的行指令速览表中, 我们可以看到代码块的形式形式内嵌, 使用`#:code`:  

```markcolondown
#:code print("line 1") -- 代码可以写在一行
#:code print("line 2")

#:code
-- 或者, 写在代码体内, 此时需要匹配通用中止(`#:end`/`#:=`), 且`#:code`之后不能有代码
hello = "Hello"
print(hello .. "Mark:down!")
#:=
```

行指令的代码输出将输出至编译器, 不直接影响文本的内容.  
使用`{{}}`的内嵌则将直接计算表达式, 并替换结果:  

```markcolondown
内嵌输出: {{ hello .. "Mark:down" }}
```

> 使用`#:raw`, `r{{}}`, 以及代码块中的` r`` `和多行的` r``` `避免`{{}}`内嵌  
